<!DOCTYPE html>
<html>
  <head>
    <title>360Â° Interactive Hotspots (A-Frame)</title>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    
    <style>
      /* Styling for the description text */
      .chat-bubble {
        color: white; 
        padding: 0.15em 0.3em; 
        border-radius: 0.5em; 
      }
    </style>

    <script>
      AFRAME.registerComponent('hover-info', {
        schema: {
          description: {type: 'string', default: 'No description provided.'},
          targetId: {type: 'string'}
        },
        init: function () {
          const parentEl = this.el; 
          const data = this.data;
          
          const textEl = parentEl.querySelector('a-text');
          let chatBubbleEl = document.querySelector(`#${data.targetId}`);
          
          if (!chatBubbleEl || !textEl) {
            console.error(`Missing element for hover-info: Bubble ID '${data.targetId}' or A-Text not found.`);
            return;
          }
          
          chatBubbleEl.setAttribute('text', { value: data.description });

          // On hover in: Hide the label and Show the bubble
          parentEl.addEventListener('mouseenter', () => {
            textEl.setAttribute('visible', false);
            chatBubbleEl.setAttribute('visible', true);
          });

          // On hover out: Show the label and Hide the bubble
          parentEl.addEventListener('mouseleave', () => {
            textEl.setAttribute('visible', true);
            chatBubbleEl.setAttribute('visible', false);
          });
        }
      });
    </script>
  </head>

  <body>
    <a-scene>
      <a-assets>
        <img id="pano" src="Indoors360.png">
      </a-assets>

      <a-sky src="#pano"></a-sky>

      <a-camera>
        <a-cursor></a-cursor>
      </a-camera>

      <a-entity 
        position="-2 2 -4"
        rotation="0 20 0" 
        
        hover-info="description: TV needs to be repaired. Never buying second-hand again.; targetId: chat-bubble-tv"
        
        animation__scalein="property: scale; to: 1.2 1.2 1.2; startEvents: mouseenter; dur: 200"
        animation__scaleout="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200"
      >
        <a-text
          value="TV"
          color="#FFFFFF"
          width="8"
          align="center"
        ></a-text>

        <a-entity 
          id="chat-bubble-tv" 
          position="0 0.5 0.1" 
          visible="false"
          billboard="" 
          text="
            value: ; 
            wrapCount: 20; 
            width: 2; 
            color: white; 
            align: center;
            baseline: top;
            xOffset: 0.05;
            yOffset: -0.05;"
          class="chat-bubble"
        ></a-entity>
      </a-entity>

      <a-entity 
        position="-23 -5 12"             
        rotation="0 115 0"             
        hover-info="description: What a view. How is the sea so close?.; targetId: chat-bubble-window-desc" animation__scalein="property: scale; to: 10 10 10; startEvents: mouseenter; dur: 200" animation__scaleout="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200"
      >
        <a-text
          value="Window"
          color="#FFFFFF"            
          width="20"
          align="center"
        ></a-text>

        <a-entity 
          id="chat-bubble-window-desc" position="0 0.5 0.1" 
          visible="false"
          billboard="" 
          text="
            value: ; 
            wrapCount: 20; 
            width: 2; 
            color: white; 
            align: center;
            baseline: top;
            xOffset: 0.05;
            yOffset: -0.05;"
          class="chat-bubble"
        ></a-entity>
      </a-entity>
      
      <a-entity 
        position="-23 -5 -10"             
        rotation="0 80 0"             
        hover-info="description: Could it be poisonous?; targetId: chat-bubble-plant"
        
        animation__scalein="property: scale; to: 10 10 10; startEvents: mouseenter; dur: 200" animation__scaleout="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200"
      >
        <a-text
          value="Plant"
          color="#FFFFFF"            
          width="20"
          align="center"
        ></a-text>

        <a-entity 
          id="chat-bubble-plant" 
          position="0 0.5 0.1" 
          visible="false"
          billboard="" 
          text="
            value: ; 
            wrapCount: 20; 
            width: 2; 
            color: white; 
            align: center;
            baseline: top;
            xOffset: 0.05;
            yOffset: -0.05;"
          class="chat-bubble"
        ></a-entity>
      </a-entity>

    </a-scene>
  </body>

</html>
